[settings]
python.uv_venv_auto = true

[tools]
age = "latest"
uv = "latest"
sops = "latest"
dprint = "0.50.1"
deno = "2.4.1"

[env]
'_'.file.path = ".env.yaml"

[tasks.dev]
description = "Start the bot"
env.DEV_MODE = "True"
run = "uv run emilybot"

[tasks.test]
description = "Run tests"
run = "uv run pytest"

[tasks.fmt]
description = "Format code"
run = "dprint fmt"

[tasks."secrets:updatekeys"]
description = "Update secret keys"
run = "sops updatekeys .env.yaml"

# --- checks ---

[tasks."check"]
description = "Run all checks before committing"
depends = ["check:*"]

[tasks."check:pyright"]
description = "Typecheck python"
alias = "pyright"
run = "uv run pyright --project=."

[tasks."check:fmt"]
description = "Check formatting"
run = "dprint check"

[tasks."check:deno"]
description = "Typecheck js-executor/ JS code"
dir = "js-executor"
run = "deno check"
